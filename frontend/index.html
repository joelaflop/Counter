<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
   <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'"> -->
   <meta http-equiv="X-Content-Security-Policy" content="default-src 'self'; script-src 'self'">
   <link href="app/css/main.css" rel="stylesheet" type="text/css" />
   <div class="pagetitlebox bg-gray">
      <h4 id="pageTitleText" class="pagetitle text-white">welcome</h4>
   </div>
</head>

<body>
   <div class="container-fluid maincontainer bg-darkgray">
      <div class="maintable main-page">
         <div class="tablecell leftbar bg-black garamond-font pt-3 pl-2 pr-0">
            <nav class="navbar navbar-nav navbar-expand-lg navbar-dark px-0">
               <ul class="navbar-nav flex-column leftbarmovementfix">
                  <a class="navbar-brand pl-0" href="#">Counter</a>
                  <li class="nav-item">
                     <a id="recently played button" class="nav-link py-1 pl-1 pr-0" href="#">
                        <img src="app/img/icons/clock-history.svg" class="invert pb-1 pr-1" alt="" width="25"
                           height="25" title="Bootstrap">history</a>
                  </li>
                  <li class="nav-item">
                     <a id="user page button" class="nav-link py-1 pl-1 pr-0" href="#">
                        <img src="app/img/icons/person-square.svg" class="invert pb-1 pr-1" alt="" width="25"
                           height="25" title="Bootstrap">user</a>
                  </li>
                  <li class="nav-item">
                     <a id="data page button" class="nav-link pt-1 pb-0 pl-1 pr-0" href="#">
                        <img src="app/img/icons/clipboard-data.svg" class="invert pb-1 pr-1" alt="" width="25"
                           height="25" title="Bootstrap">data</a>
                     <div id="datadropdown" class="pl-4">
                        <a id="datatype1" class="nav-link py-0 pl-2 pr-0" href="#">counts</a>
                        <a id="datatype2" class="nav-link py-0 pl-2 pr-0" href="#">type2</a>
                     </div>
                  </li>
               </ul>
            </nav>
         </div>
         <div id="mainpageholder" class="mainpageholder">
            <div id="mainpage">
               <!-- <div class="pagetitlebox bg-gray">
               <h4 class="pagetitle text-white">welcome</h4>
            </div> -->
            </div>
         </div>
      </div>
      <div class=" bottombar fixed-bottom garamond-font bg-gray text-white pt-0 pl-0">
         <div class="leftbar pt-0 pl-3 " id='nowplayingleftbar'></div>
         <div class="avoidleftbar" id="nowplaying"></div>
      </div>

   </div>

   <div class="invisible">
      <div id="countsPage">
         <!-- <div class="pagetitlebox bg-gray">
            <h4 class="pagetitle text-white">history</h4>
         </div> -->
         <div id="recentlyplaying" class=""></div>
         <!-- mainpagedrop -->
      </div>

      <div id="userPage">
         <!-- <div class="pagetitlebox bg-gray">
            <h4 class="pagetitle text-white">user profile</h4>
         </div> -->
         <div id="usermainpage" class=""></div>
         <!-- mainpagedrop -->
      </div>

      <div id="dataPage">
         <!-- <div class="pagetitlebox bg-gray">
            <h4 class="pagetitle text-white">data insights</h4>
         </div> -->
         <div id="datamainpage" class="">
            <p class=" text-white">menu of things to choose from</p>
         </div>
         <!-- mainpagedrop -->
      </div>

      <div id="dataType1Page">
         <!-- <div class="pagetitlebox bg-gray">
            <h4 class="pagetitle text-white">data insights</h4>
         </div> -->
         <div class="pr-4 pl-2 pt-1 text-white">
            <div id="dataType1ArtistCounts" class="svg-container">
               <h4>top artists</h4>
            </div>
            <div id="dataType1AlbumCounts" class="svg-container">
               <h4>top albums</h4>
            </div>
            <div id="dataType1SongCounts" class="svg-container">
               <h4>top songs</h4>
            </div>
         </div>
         <!-- mainpagedrop -->
      </div>

      <div id="dataType2Page">
         <!-- <div class="pagetitlebox bg-gray">
            <h4 class="pagetitle text-white">data insights</h4>
         </div> -->
         <div id="dataType2mainpage" class="">
            <p class=" text-white">lmao2</p>
         </div>
         <!-- mainpagedrop -->
      </div>

      <div id='playingsomething'>
         <h4 class="nowtext">now</h4>
         <h4 class="playingtext">playing</h4>
         <!-- <span class="navbar-brand pb-0 h1">now</span>
      <span class="navbar-brand pt-0 h1">playing</span> -->
      </div>
   </div>

   <!-- You can also require other files to run in this process -->
   <script src="app/js/mainRenderer.js"></script>
   <!-- <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script> -->
   <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
   <script src="./app/resources/Handlebars/track_object_full.precompiled.js"></script>
   <script src="./app/resources/Handlebars/user_object.precompiled.js"></script>
   <script src="./app/resources/Handlebars/recently_played_object_full.precompiled.js"></script>

   <script>

      var full_track_template = Handlebars.templates.track_object_full;
      ipcRenderer.on("auth-button-task-finished", function (event, arg) {
         console.log("renderer got confirmation of authbutton click")
      });
      ipcRenderer.on("nowplaying-button-task-finished", function (event, track) {
         console.log('got a nowplaying finish')
         if (track === "nothingplaying") {
            let nothingdiv = document.getElementById('nowplaying');
            nothingdiv.innerHTML = '<h5 class="pt-2 pl-3">you\'re not playing anything</h5>'
            document.getElementById('nowplayingleftbar').innerHTML = ''
            document.getElementById('mainpageholder').style.height = 'calc(100vh - 80px)';
            document.getElementById('mainpageholder').style.marginBottom = '50px';
         } else {
            document.getElementById('nowplaying').innerHTML = full_track_template(track)
            document.getElementById('nowplaying').className = "avoidleftbar"
            document.getElementById('nowplayingleftbar').innerHTML = document.getElementById('playingsomething').innerHTML
            document.getElementById('mainpageholder').style.height = 'calc(100vh - 148px)'
            document.getElementById('mainpageholder').style.marginBottom = '118px';
         }
      });
      var recently_played_track_template = Handlebars.templates.recently_played_object_full;
      ipcRenderer.on("recentlyplayed-button-task-finished", function (event, tracks) {
         parent = document.getElementById('recentlyplaying')
         parent.innerHTML = ""
         for (let i = 0; i < tracks.length; i++) {
            child = document.createElement('div');
            child.className = "text-white";
            appendChild = parent.appendChild(child)
            appendChild.innerHTML = recently_played_track_template(tracks[i]);
         }
      });

   </script>
   <script>
      var user_template = Handlebars.templates.user_object;
      ipcRenderer.on("user-button-task-finished", function (event, user) {
         console.log('got a user page finish')
         console.log(user)
         // document.getElementById('pageTitleText').innerText = 'user page';
         document.getElementById('usermainpage').innerHTML = user_template(user)
      });
   </script>
   <script>
      
   </script>
</body>

</html>
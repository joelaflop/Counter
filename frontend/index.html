<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
   <!-- <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'"> -->
   <meta http-equiv="X-Content-Security-Policy" content="default-src 'self'; script-src 'self'">
   <link href="app/css/main.css" rel="stylesheet" type="text/css" />
   <title class="garamond-font">Counter alphalphalphalpha</title>
   <nav class="navbar fixed-top navbar-light bg-light">
      <a class="navbar-brand garamond-font" href="#">Counter alpha</a>
      <div class="container-fluid garamond-font">
         We are using Node.js <span id="node-version"></span>,
         Chromium <span id="chrome-version"></span>,
         and Electron <span id="electron-version"></span>.
      </div>
   </nav>
</head>

<body>
   <div class="container-fluid">
      <div class="row">
         <div class="col-2 position-fixed garamond-font">
            <h4>Menu:</h4>
            <button id="now playing button" type="button">now</button>
            <button id="recently played button" type="button">recent</button>
            <button id="user page button" type="button">user</button>
            <button id="data page button" type="button">data</button>
         </div>
         <div id="mainpage" class="col-10 offset-2  garamond-font"></div>
      </div>
   </div>
   <div class="nowplaying garamond-font">
      <div id="nowplaying"></div>
   </div>

   <div id="countsPage">
      <div id="recentlyplaying"></div>
   </div>

   <div id="userPage">
      <h1>user profile</h1>
   </div>

   <div id="dataPage">
      <h1>data insights</h1>
   </div>

   <!-- You can also require other files to run in this process -->
   <script src="app/js/mainRenderer.js"></script>
   <!-- <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script> -->
   <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
   <script src="./app/resources/Handlebars/track_object_full.precompiled.js"></script>

   <script>
      var full_track_template = Handlebars.templates.track_object_full;
      var simple_track_template = Handlebars.templates.track_object_simplified;
      ipcRenderer.on("auth-button-task-finished", function(event, arg) {
         console.log("renderer got confirmation of authbutton click")
      });
      ipcRenderer.on("nowplaying-button-task-finished", function(event, track) {
         if (track === "nothingplaying") {
            let nothingplayingdiv = document.createElement('div');
            document.getElementById('nowplaying').innerHTML = 'were not playing nothing'
         } else {
            document.getElementById('nowplaying').innerHTML = full_track_template(track)
         }
      });
      ipcRenderer.on("recentlyplayed-button-task-finished", function(event, tracks) {
         parent = document.getElementById('recentlyplaying')
         parent.innerHTML = ""
         for (let i = 0; i < tracks.length; i++) {
            console.log(tracks[i])
            child = document.createElement('div');
            appendChild = parent.appendChild(child)
            appendChild.innerHTML = full_track_template(tracks[i]);
            console.log(1)
         }
      });
   </script>
</body>

</html>
